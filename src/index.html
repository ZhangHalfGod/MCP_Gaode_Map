<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>长辈出行助手</title>
    <!-- 引入TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- 配置TailwindCSS -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4A6FA5',
                        secondary: '#72A0C1',
                        accent: '#F18F01',
                        light: '#F5F5F5',
                        dark: '#333333'
                    },
                    fontFamily: {
                        sans: ['Noto Sans SC', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            .button-hover {
                @apply transition-all duration-300 hover:scale-105 hover:shadow-lg active:scale-95;
            }
            .fade-in {
                animation: fadeIn 0.5s ease-in;
            }
            .slide-up {
                animation: slideUp 0.5s ease-out;
            }
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            @keyframes slideUp {
                from { 
                    opacity: 0;
                    transform: translateY(20px);
                }
                to { 
                    opacity: 1;
                    transform: translateY(0);
                }
            }
        }
    </style>
</head>
<body class="bg-light text-dark min-h-screen flex flex-col">
    <!-- 页面头部 -->
    <header class="bg-primary text-white py-6 shadow-md">
        <div class="container mx-auto px-4">
            <h1 class="text-[28px] md:text-[36px] font-bold text-center text-shadow fade-in">
                长辈出行助手
            </h1>
            <p class="text-[18px] text-center mt-2 text-white/90 fade-in" style="animation-delay: 0.2s">
                轻松规划您的出行路线
            </p>
        </div>
    </header>

    <!-- 主要内容 -->
    <main class="flex-grow container mx-auto px-4 py-8">
        <!-- 路线信息卡片 -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8 slide-up" style="animation-delay: 0.3s">
            <div class="flex items-start space-x-4">
                <div class="bg-green-500 text-white rounded-full p-3 mt-1">
                    <span class="material-icons text-[24px]">place</span>
                </div>
                <div class="flex-grow">
                    <h2 class="text-[24px] font-bold mb-1">出发地点</h2>
                    <p class="text-[20px]" id="startAddress">广州市越秀区彩虹桥</p>
                </div>
            </div>
            
            <!-- 路线箭头 -->
            <div class="flex justify-center my-4">
                <span class="material-icons text-[32px] text-primary">arrow_downward</span>
            </div>
            
            <div class="flex items-start space-x-4">
                <div class="bg-red-500 text-white rounded-full p-3 mt-1">
                    <span class="material-icons text-[24px]">flag</span>
                </div>
                <div class="flex-grow">
                    <h2 class="text-[24px] font-bold mb-1">目的地</h2>
                    <p class="text-[20px]" id="endAddress">广州塔（小蛮腰）</p>
                </div>
            </div>
        </div>

        <!-- 出行方式选择 -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <!-- 打车选项 -->
            <div class="bg-primary rounded-xl shadow-lg overflow-hidden button-hover">
                <a href="" id="taxiLink" class="block p-6 h-full">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-[24px] font-bold text-white">打车</h3>
                        <span class="bg-white text-primary rounded-full p-3">
                            <span class="material-icons text-[28px]">local_taxi</span>
                        </span>
                    </div>
                    <p class="text-[16px] text-white/90 mb-4">
                        一键呼叫出租车，直接前往目的地
                    </p>
                    <div class="bg-white/20 rounded-lg p-4">
                        <p class="text-white text-[18px] font-medium">预计行程时间: <span id="taxiTime">约25分钟</span></p>
                    </div>
                </a>
            </div>

            <!-- 公交车选项 -->
            <div class="bg-secondary rounded-xl shadow-lg overflow-hidden button-hover">
                <a href="" id="busLink" class="block p-6 h-full">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-[24px] font-bold text-white">公交车</h3>
                        <span class="bg-white text-secondary rounded-full p-3">
                            <span class="material-icons text-[28px]">directions_bus</span>
                        </span>
                    </div>
                    <p class="text-[16px] text-white/90 mb-4">
                        查看公交路线，绿色环保出行
                    </p>
                    <div class="bg-white/20 rounded-lg p-4">
                        <p class="text-white text-[18px] font-medium">预计行程时间: <span id="busTime">约45分钟</span></p>
                    </div>
                </a>
            </div>

            <!-- 自驾选项 -->
            <div class="bg-green-700 rounded-xl shadow-lg overflow-hidden button-hover">
                <a href="" id="driveLink" class="block p-6 h-full">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-[24px] font-bold text-white">开车去</h3>
                        <span class="bg-white text-green-700 rounded-full p-3">
                            <span class="material-icons text-[28px]">directions_car</span>
                        </span>
                    </div>
                    <p class="text-[16px] text-white/90 mb-4">
                        自驾导航路线，途径主要道路
                    </p>
                    <div class="bg-white/20 rounded-lg p-4">
                        <p class="text-white text-[18px] font-medium">预计行程时间: <span id="driveTime">约30分钟</span></p>
                    </div>
                </a>
            </div>
        </div>
        
        <!-- 自驾路线详细信息 -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8 slide-up" style="animation-delay: 0.6s">
            <h2 class="text-[24px] font-bold mb-4 flex items-center">
                <span class="material-icons text-[24px] mr-2 text-green-700">directions_car</span>
                自驾路线详情
            </h2>
            <div class="space-y-4">
                <div class="flex items-start">
                    <span class="material-icons text-[20px] mr-2 text-blue-500 mt-1">route</span>
                    <p class="text-[20px]"><strong>推荐路线：</strong>中山七路 → 康王中路 → 人民路 → 沿江西路 → 艺洲路</p>
                </div>
                <div class="flex items-start">
                    <span class="material-icons text-[20px] mr-2 text-amber-500 mt-1">local_parking</span>
                    <p class="text-[20px]"><strong>停车场：</strong>广州塔地下停车场（收费标准：10元/小时）</p>
                </div>
                <div class="flex items-start">
                    <span class="material-icons text-[20px] mr-2 text-green-500 mt-1">straight</span>
                    <p class="text-[20px]"><strong>总里程：</strong>约8.5公里，预估油费约15元</p>
                </div>
                <div class="flex items-start">
                    <span class="material-icons text-[20px] mr-2 text-red-500 mt-1">warning</span>
                    <p class="text-[20px]"><strong>高峰期提示：</strong>7:30-9:00和17:30-19:00建议提前15分钟出发</p>
                </div>
            </div>
        </div>

        <!-- 实时交通信息 -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8 slide-up" style="animation-delay: 0.5s">
            <h2 class="text-[24px] font-bold mb-4 flex items-center">
                <span class="material-icons text-[24px] mr-2 text-accent">traffic</span>
                实时交通信息
            </h2>
            <div class="space-y-4">
                <div class="flex items-center">
                    <span class="material-icons text-[20px] mr-2 text-green-500">check_circle</span>
                    <p class="text-[20px]" id="trafficStatus">当前路线交通状况良好，无拥堵</p>
                </div>
                <div class="flex items-center">
                    <span class="material-icons text-[20px] mr-2 text-blue-500">info</span>
                    <p class="text-[20px]" id="travelTip">建议提前15分钟出发，避开晚高峰</p>
                </div>
            </div>
        </div>

        <!-- 目的地信息 -->
        <div class="bg-white rounded-xl shadow-lg p-6 slide-up" style="animation-delay: 0.7s">
            <h2 class="text-[24px] font-bold mb-4 flex items-center">
                <span class="material-icons text-[24px] mr-2 text-accent">info</span>
                目的地信息
            </h2>
            <div class="space-y-4">
                <div class="flex items-center">
                    <span class="material-icons text-[20px] mr-2 text-blue-500">schedule</span>
                    <p class="text-[20px]" id="openingHours">广州塔开放时间：09:30-22:30</p>
                </div>
                <div class="flex items-center">
                    <span class="material-icons text-[20px] mr-2 text-amber-500">warning</span>
                    <p class="text-[20px]" id="notice">今日无临时管制，可正常前往</p>
                </div>
            </div>
        </motion.div>
    </main>

    <!-- 页脚 -->
    <footer class="bg-dark text-white py-6 mt-8">
        <div class="container mx-auto px-4 text-center">
            <p class="text-[18px]">长辈出行助手 © 2025</p>
            <p class="text-[16px] text-white/70 mt-2">祝您出行顺利，一路平安！</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // 等待DOM加载完成
        document.addEventListener('DOMContentLoaded', function() {
            // 获取元素
            const taxiLinkElement = document.getElementById('taxiLink');
            const busLinkElement = document.getElementById('busLink');
            const driveLinkElement = document.getElementById('driveLink'); // 新增自驾选项
            const startAddressElement = document.getElementById('startAddress');
            const endAddressElement = document.getElementById('endAddress');
            
            // 默认起点和终点信息
            const defaultStartAddress = '广州市越秀区彩虹桥';
            const defaultEndAddress = '广州塔（小蛮腰）';
            
            // 默认坐标
            const startLat = 23.1265;
            const startLng = 113.2578;
            const endLat = 23.1141;
            const endLng = 113.3255;
            
            // 高德地图Web服务API Key (请替换为您的实际Key)
            const apiKey = 'd9a9c893a2c07f7e6c00a149545363d8';
            
            // 检测是否为移动设备
            function isMobileDevice() {
                return (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));
            }
            
            // 生成适合当前设备的链接
            function generateLinkForDevice() {
                if (isMobileDevice()) {
                    // 移动设备：使用amapuri协议，直接打开高德地图APP
                    return {
                        taxiLink: `amapuri://openFeature?featureName=taxi&sourceApplication=长辈出行助手&startLat=${startLat}&startLon=${startLng}&startName=${encodeURIComponent(defaultStartAddress)}&destLat=${endLat}&destLon=${endLng}&destName=${encodeURIComponent(defaultEndAddress)}`,
                        busLink: `amapuri://route/plan?sourceApplication=长辈出行助手&slat=${startLat}&slon=${startLng}&sname=${encodeURIComponent(defaultStartAddress)}&dlat=${endLat}&dlon=${endLng}&dname=${encodeURIComponent(defaultEndAddress)}&dev=0&t=1`,
                        driveLink: `amapuri://route/plan?sourceApplication=长辈出行助手&slat=${startLat}&slon=${startLng}&sname=${encodeURIComponent(defaultStartAddress)}&dlat=${endLat}&dlon=${endLng}&dname=${encodeURIComponent(defaultEndAddress)}&dev=0&t=0` // t=0表示驾车
                    };
                } else {
                    // 非移动设备：使用更可靠的高德地图Web版本链接格式
                    return {
                        // 使用高德地图Web服务API - 驾车导航专用格式
                        // 修正参数名称以符合高德Web服务API规范
                        // 使用高德地图网页版导航端点，支持地址自动填充
                        taxiLink: `https://ditu.amap.com/navigation?from=${encodeURIComponent(defaultStartAddress)}&fromcoord=${startLng},${startLat}&to=${encodeURIComponent(defaultEndAddress)}&tocoord=${endLng},${endLat}&mode=taxi&key=${apiKey}`,
                        busLink: `https://ditu.amap.com/navigation?from=${encodeURIComponent(defaultStartAddress)}&fromcoord=${startLng},${startLat}&to=${encodeURIComponent(defaultEndAddress)}&tocoord=${endLng},${endLat}&mode=bus&key=${apiKey}`,
                        driveLink: `https://ditu.amap.com/navigation?from=${encodeURIComponent(defaultStartAddress)}&fromcoord=${startLng},${startLat}&to=${encodeURIComponent(defaultEndAddress)}&tocoord=${endLng},${endLat}&mode=car&key=${apiKey}`
                    };
                }
            }
            
            // 获取适合当前设备的链接
            const links = generateLinkForDevice();
            
            // 整合用户位置检测的高德地图打开函数
            function openGaodeMap(mode) {
                // 从Address.md获取的固定坐标
                const startLat = 23.1265;
                const startLng = 113.2578;
                const endLat = 23.1141;
                const endLng = 113.3255;
                const startName = encodeURIComponent(defaultStartAddress);
                const endName = encodeURIComponent(defaultEndAddress);
                
                // 尝试获取用户当前位置
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        // 位置获取成功回调
                        function(position) {
                            const usrLat = position.coords.latitude;
                            const usrLon = position.coords.longitude;
                            
                            // 导航模式 - 使用用户实时位置作为起点
                            const navUrl = `https://uri.amap.com/navigation?from=${usrLon},${usrLat},我的位置&to=${endLng},${endLat},${endName}&mode=${mode === 'taxi' ? 'taxi' : mode === 'bus' ? 'bus' : 'driving'}&policy=0&src=mypage&coordinate=gaode`;
                            window.location.href = navUrl;
                        },
                        // 位置获取失败回调 - 使用固定起点
                        function(error) {
                            console.log('无法获取位置，使用默认起点:', error.message);
                            const markerUrl = `https://uri.amap.com/marker?position=${endLng},${endLat}&name=${endName}&src=mypage&coordinate=gaode`;
                            window.location.href = markerUrl;
                        },
                        // 位置获取选项
                        { timeout: 5000, enableHighAccuracy: false }
                    );
                } else {
                    // 浏览器不支持Geolocation - 使用固定起点
                    const markerUrl = `https://uri.amap.com/marker?position=${endLng},${endLat}&name=${endName}&src=mypage&coordinate=gaode`;
                    window.location.href = markerUrl;
                }
            }
            
            // 添加点击事件处理
            taxiLinkElement.addEventListener('click', function(e) {
                e.preventDefault();
                openGaodeMap('taxi');
            });
            
            busLinkElement.addEventListener('click', function(e) {
                e.preventDefault();
                openGaodeMap('bus');
            });
            
            if (driveLinkElement) {
                driveLinkElement.addEventListener('click', function(e) {
                    e.preventDefault();
                    openGaodeMap('drive');
                });
            }
            
            // 添加平滑滚动效果
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });
        });
    </script>
</body>
</html>